\hypertarget{_object_detection_8cpp-example}{}\doxysection{Object\+Detection.\+cpp}
Example of using \mbox{\hyperlink{_object_detection_8hpp}{Object\+Detection.\+hpp}}.

Example of using \mbox{\hyperlink{_object_detection_8hpp}{Object\+Detection.\+hpp}}


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_object_detection_8hpp}{Algorithm/Object\_Detection/ObjectDetection.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_data_struct_8hpp}{Utils/DataStruct.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <opencv2/opencv.hpp>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ File\ path}}
\DoxyCodeLine{std::string\ data\_path\ =\ \textcolor{stringliteral}{"{}../../../data/"{}};}
\DoxyCodeLine{std::string\ vid\_path\ =\ data\_path\ +\ \textcolor{stringliteral}{"{}straight2.h264"{}};}
\DoxyCodeLine{\textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{}
\DoxyCodeLine{std::unique\_ptr<std::vector<ImageData>>\ imgData\ =}
\DoxyCodeLine{\ \ \ \ std::make\_unique<std::vector<ImageData>>();}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ Parameters}}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ maxCorners\ =\ 1000;}
\DoxyCodeLine{\textcolor{keywordtype}{float}\ threshold\ =\ 2.0;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main()\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Create\ ObjectDetector\ object}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Open\ the\ video\ file}}
\DoxyCodeLine{\ \ \ \ cv::VideoCapture\ cap(vid\_path);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (!cap.isOpened())\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Error\ opening\ video\ stream\ or\ file"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Read\ until\ video\ is\ completed}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{while}\ (1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cv::Mat\ frame;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Capture\ frame-\/by-\/frame}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cap\ >>\ frame;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ frame\ is\ empty,\ break\ immediately}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (frame.empty())}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Fill\ the\ vector\ with\ the\ frames}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ imgData-\/>push\_back(\mbox{\hyperlink{struct_image_data}{ImageData}}(frame));}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Run\ image\ allignment\ if\ necessary}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Create\ ObjectDetector\ object}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{class_detection_1_1_object_detection}{Detection::ObjectDetection}}\ objectDetection(maxCorners);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Compute\ the\ flow\ for\ the\ first\ frame\ and\ then\ update\ the\ flow\ for\ the}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ rest\ of\ the\ frames}}
\DoxyCodeLine{\ \ \ \ imgData-\/>at(0).SetFlow(objectDetection.\mbox{\hyperlink{class_detection_1_1_object_detection_abe908ace743364f1ef736879f47087e7}{init}}(imgData-\/>at(0).image));}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ imgData-\/>size();\ i++)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ imgData-\/>at(i).SetFlow(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ objectDetection.\mbox{\hyperlink{class_detection_1_1_object_detection_a0e0b1b3b45ff793a30daaa7f8ba37064}{updateFlow}}(imgData-\/>at(i),\ imgData-\/>at(i\ -\/\ 1)));}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Threshold\ the\ points}}
\DoxyCodeLine{\ \ \ \ std::vector<int>\ ids;}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ imgData-\/>at(0).flow.GetPoints().size();\ i++)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ids.push\_back(i);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ imgData-\/>size();\ i++)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ imgData-\/>at(i).flow.thresholdPointsId(ids,\ imgData-\/>at(i\ -\/\ 1).flow,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ threshold);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ thresholded\ points}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ imgData-\/>size();\ i++)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ imgData-\/>at(i).SetDetection(imgData-\/>at(i).flow.GetPointsById(ids));}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Draw\ the\ results}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ imgData-\/>size();\ i++)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cv::Mat\ img\ =\ imgData-\/>at(i).image;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cv::Rect\ rect\ =\ imgData-\/>at(i).detection.GetRect();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cv::rectangle(img,\ rect,\ cv::Scalar(0,\ 0,\ 255),\ 2);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cv::imshow(\textcolor{stringliteral}{"{}img"{}},\ img);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cv::waitKey(20);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ cap.release();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\}}

\end{DoxyCodeInclude}
 